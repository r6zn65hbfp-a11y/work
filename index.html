<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Finding me</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      background: #f5f5f5;
    }

    header {
      margin-top: 24px;
      text-align: center;
    }

    h1 {
      margin: 0 0 8px;
      font-size: 24px;
    }

    p.subtitle {
      margin: 0 0 16px;
      color: #555;
      font-size: 14px;
    }

    #game-container {
      margin-top: 12px;
      margin-bottom: 16px;
      position: relative;
      display: inline-block;
      background: #fff;
      padding: 8px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    #game-image {
      display: block;
      max-width: 90vw;
      width: 800px;   /* 视觉上的显示宽度，可改 */
      height: auto;
      cursor: pointer;
      border-radius: 4px;
    }

    #message {
      min-height: 24px;
      font-size: 16px;
      margin-bottom: 12px;
    }

    #hint {
      font-size: 12px;
      color: #888;
      margin-bottom: 24px;
      text-align: center;
      max-width: 90vw;
    }

    /* 小小的点击反馈圆点（你自己调试用） */
    .click-marker {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 2px solid rgba(0,0,0,0.4);
      pointer-events: none;
      transform: translate(-50%, -50%);
    }
  </style>
</head>
<body>
  <header>
    <h1>Me in Christmas Eve</h1>
    <p class="subtitle">Click the red packet to get bingo!</p>
  </header>

  <div id="game-container">
    <img id="game-image" src="IMG_4835.JPG" alt="Game Image">
  </div>

  <p id="message"></p>
  <p id="hint">Yiyao Gong</p>

  <script>
    // ====== 原图尺寸（你当前使用的基准尺寸）======
    const baseWidth = 1137;
    const baseHeight = 1520;

    // ====== 两个目标点 + 各自容错 ======
    // tolX = 横向容错; tolY = 纵向容错
    const targets = [
      {
        name: 'target1',
        x: 69,
        y: 1222,
        tolX: 20,
        tolY: 20
      },
      {
        name: 'target2',
        x: 671,
        y: 692,
        tolX: 20,
        tolY: 20
      }
    ];

    const img = document.getElementById('game-image');
    const msg = document.getElementById('message');
    const container = document.getElementById('game-container');

    let markerEl = null; // 显示你点击位置的小圆点

    img.addEventListener('click', function (event) {
      // 容器和图片各自的矩形信息
      const containerRect = container.getBoundingClientRect();
      const imgRect = img.getBoundingClientRect();

      // 点击点相对于「容器」的坐标 —— 用来画小圆点，避免偏移
      const clickXOnContainer = event.clientX - containerRect.left;
      const clickYOnContainer = event.clientY - containerRect.top;

      // 点击点相对于「图片本身」的坐标 —— 用来做坐标换算和命中判断
      const clickXOnImg = event.clientX - imgRect.left;
      const clickYOnImg = event.clientY - imgRect.top;

      const displayWidth = imgRect.width;
      const displayHeight = imgRect.height;

      // 等比例换算到“原图坐标系”（baseWidth × baseHeight）上
      const scaledX = clickXOnImg * baseWidth / displayWidth;
      const scaledY = clickYOnImg * baseHeight / displayHeight;

      // 画圆点（现在是严格跟着你点的位置走）
      showClickMarker(clickXOnContainer, clickYOnContainer);

      // 判断是否命中某个目标
      let hitTarget = null;
      for (const t of targets) {
        const dx = Math.abs(scaledX - t.x);
        const dy = Math.abs(scaledY - t.y);
        if (dx <= t.tolX && dy <= t.tolY) {
          hitTarget = t;
          break;
        }
      }

      if (hitTarget) {
        if (hitTarget === targets[0]) {
          msg.textContent = 'Bingo! Thank you for seeing me.';
        } else if (hitTarget === targets[1]) {
          msg.textContent = 'Bingo! Haha you found me!';
        }
      } else {
        msg.textContent = 'Not quite! Try again!';
      }

      // Console 里输出你刚才点击的“原图坐标”，方便你调试
      console.log(`点击（原图坐标）：x=${scaledX.toFixed(0)}, y=${scaledY.toFixed(0)}`);
    });

    // 显示点击位置的小圆点（只显示最后一次点击）
    function showClickMarker(x, y) {
      if (!markerEl) {
        markerEl = document.createElement('div');
        markerEl.className = 'click-marker';
        container.appendChild(markerEl);
      }
      markerEl.style.left = x + 'px';
      markerEl.style.top = y + 'px';
    }
  </script>
</body>
</html>
